<?php
$title = 'Latest articles';
$this->headTitle($title);
?>
<h2><?php echo $this->escapeHtml($title); ?></h2>

<?php
if(!$articles)
{
    echo '<p>There no articles</p>';
}
else
{
    echo '<ul>';
    foreach ($articles as $article) :
?>
        <hr>
        <li>
            <h3>
                <a href="<?php echo $this->url('csn-cms/default', // SUPER IMPORTANT use csn-cms/<segment> NOT ONLY csn-cms
                                    array('controller' => 'article', 'action'=>'view', 'id' => $article->getId()));?>">
                <?php echo $this->escapeHtml($article->getTitle());?>
                </a>
            </h3>
                <span><?php echo $article->getCreated()->format('F j, Y H:i'); if(is_object($article->getAuthor())) echo ' by ' . $this->escapeHtml($article->getAuthor()->getUsername());?></span>
            <?php echo $article->getIntroText();?>
        </li>
<?php
    endforeach;
    echo '</ul>';
}?>
<?php
$counter = 0;
if(!$mostCommentedArticles)
{
    echo '<p>There no articles</p>';
}
else
{
	echo '<span>TOP FIVE COMMENTED Articles';
?>
	<table border="1" class="table">
	<th> Title </th>	
	<th> Intro text </th>
	<th> Created </th>
	<th> Author </th>
	<th> Comments </th>
	<th> More </th>
	<?php
    foreach ($mostCommentedArticles as $currentArticle) :
?>
<tr>
        <td>
                <a href="<?php echo $this->url('csn-cms/default', // SUPER IMPORTANT use csn-cms/<segment> NOT ONLY csn-cms
                                    array('controller' => 'article', 'action'=>'view', 'id' => $currentArticle->getId()));?>">
                <?php echo $this->escapeHtml($currentArticle->getTitle());?>
                </a>
		</td>
		<td>
		<?php echo $currentArticle->getIntroText();?>
		</td>
		<td>
			<?php echo $currentArticle->getCreated()->format('F j, Y H:i'); ?>
		</td>
		<td>
			<?php if(is_object($currentArticle->getAuthor())) echo $this->escapeHtml($currentArticle->getAuthor()->getUsername()); ?>
		</td>
		<td>
			<?php echo $countOfComments[$counter]; ?>
		</td>
		<td>
			<a href="<?php echo $this->url('csn-cms/default', // SUPER IMPORTANT use csn-cms/<segment> NOT ONLY csn-cms
            array('controller' => 'translation', 'action'=>'index', 'id' => $currentArticle->getId()));?>">Translations</a>
        <a href="<?php echo $this->url('csn-cms/default', // SUPER IMPORTANT use csn-cms/<segment> NOT ONLY csn-cms
            array('controller' => 'comment', 'action'=>'index', 'id' => $currentArticle->getId()));?>">Comments</a>
			<a href="<?php echo $this->url('csn-cms/default', // SUPER IMPORTANT use csn-cms/<segment> NOT ONLY csn-cms
            array('controller' => 'article', 'action'=>'view', 'id' => $article->getId()));?>">View</a>
		<a href="<?php echo $this->url('csn-cms/default', // SUPER IMPORTANT use csn-cms/<segment> NOT ONLY csn-cms
            array('controller' => 'article', 'action'=>'edit', 'id' => $article->getId()));?>">Edit</a>
        <a href="<?php echo $this->url('csn-cms/default', // SUPER IMPORTANT use csn-cms/<segment>
            array('controller' => 'article', 'action'=>'delete', 'id' => $article->getId()));?>" onclick="return confirm('Do you really want to delete this record?')">Delete</a>
		</td>
		<?php $counter++; endforeach; } ?>
</tr>
</span>
